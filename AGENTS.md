# Repository Guidelines

## プロジェクト構成とモジュール配置
このリポジトリはビルドステップを持たない軽量な静的サイトとして設計されています。変更は `public/` 配下に閉じることで CI の挙動をシンプルに保てます。
- ルート直下には README.md と `.github/workflows/deploy.yml` があり、GitHub Pages への自動デプロイを制御します。
- アプリ本体は `public/index.html` に完結した Three.js + OrbitControls 構成です。追加の JS モジュールやスタイルは同ディレクトリ内で管理し、ビルドレスで読み込めるよう ES Modules を維持してください。
- 静的アセットを増やす場合は `public/assets/` を作成し、軽量ファイルと最適化済みテクスチャのみを配置します。
- ライブラリアップデートは import map のバージョン番号を更新し、動作検証後にコミットしてください。

## ビルド・開発コマンド
- `cd public && python -m http.server 4173` : ローカル開発サーバーを起動し、http://localhost:4173 で動作確認します。
- `npx serve public` : Node.js 環境がある場合の代替サーバー。Cache-Control を含めた挙動を確認できます。
- CI / CD は GitHub Actions で `public/` をそのままデプロイします。ビルド手順は追加不要ですが、将来のツール導入時は `public` に成果物を落とす構成を守ってください。
- デプロイ直前には `git status` で意図しない生成物が無いことを必ず確認してください。

## コーディングスタイルと命名
- HTML / CSS / JS ともにインデントは 2 スペース、セミコロン未使用の ES6+ 構文を採用します。
- Three.js オブジェクトは `scene`, `camera`, `renderer` のように用途中心の英語名を付け、UI 要素は `helpPanel` のようにキャメルケースで揃えます。
- 共通パラメータは `const params = { ... }` のようにまとめ、マジックナンバーを避けて再利用しやすくします。
- CDN 経由で読み込むライブラリは import map に登録し、バージョン番号を明示してください。
- コメントは複雑な数式や Three.js 固有パラメータに限定し、視覚効果の意図を簡潔に添えてください。

## テスト方針
- `index.html` の `<script>` 末尾にある簡易診断ハーネスを利用し、主要機能を `check('name', () => ...)` で検証します。新機能を追加したら最小限のチェックを増やしてください。
- ローカルプレビューで `Diagnostics / Tests` パネルが全て PASS になることを出荷前の最低条件とします。
- 三次元描画の破綻を防ぐため、主要ブラウザ (Chrome, Firefox, Safari) の最新版で表示確認し、差分があれば PR で共有してください。
- 描画負荷が増す変更では FPS ドロップを記録し、必要に応じて `requestAnimationFrame` ループ内の処理をプロファイルしてください。

## コミットと PR ガイドライン
- 既存履歴は短い英語センテンス (例: `first release`) でまとまっています。コミットは 50 文字以内の命令形サマリと必要に応じた本文を `git commit -m "Add orbit damping control"` の形式で書いてください。
- PR では変更の目的、スクリーンショットまたは短い録画 (UI 変更時) を添え、関連 Issue があれば `Closes #` 形式でリンクします。
- デプロイ対象が `public/` に収まっているか、不要な大容量ファイルが含まれていないかをセルフチェックしたうえでレビューを依頼してください。
- フィーチャーブランチ名は `feature/<短い説明>` や `fix/<課題ID>` のようにスラッグ化し、履歴から意図が読み取れるように保ってください。

## セキュリティと設定ヒント
- Secrets や API キーはクライアント側に埋め込まず、必要な場合は別途サーバーサイドを用意してプロキシ経由で扱います。
- GitHub Actions のトークンは既定の `GITHUB_TOKEN` のみを使用し、追加シークレットが必要な場合はメンテナに相談してください。
- 外部 CDN に依存するため、障害時に備えて利用バージョンのリリースノートを定期的に確認し、破壊的変更が予告された場合は早めにローカルホスト用バックアップを用意してください。
